<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:enums="clr-namespace:LifeSyncApp.Models.TaskManager.Enums"
             x:Class="LifeSyncApp.Views.TaskManager.TaskItem.ManageTaskItemPopup">

    <Border BackgroundColor="White"
            StrokeShape="RoundRectangle  16 16 0 0"
            Padding="0"
            HorizontalOptions="Center"
            VerticalOptions="End"
            HeightRequest="720">

        <Grid RowDefinitions="Auto,Auto,*,Auto"
              RowSpacing="0">

            <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Padding="16,0">
                <Label Text="Nova Tarefa"
                       FontSize="16"
                       FontAttributes="None"
                       TextColor="#111"
                       VerticalOptions="Center"/>

                <ImageButton Grid.Column="1" 
                             Source="close.svg" 
                             BackgroundColor="Transparent" 
                             Padding="8" 
                             Margin="8" 
                             Command="{Binding CloseManageTaskModalCommand}" />
            </Grid>

            <BoxView Grid.Row="1" HeightRequest="1" Color="#EEEEEE"/>

            <ScrollView Grid.Row="2" Padding="16,12">
                <VerticalStackLayout Spacing="14">

                    <Label Text="Título" FontSize="12" TextColor="#6B7280"/>
                    <Border Stroke="#E5E7EB" StrokeThickness="1" StrokeShape="RoundRectangle 10" BackgroundColor="White">
                        <Entry Placeholder="Ex: Finalizar relatório mensal"
                               PlaceholderColor="#9CA3AF"
                               Text="{Binding NewTaskTitle}"
                               BackgroundColor="Transparent"
                               Margin="10,2"/>
                    </Border>

                    <Label Text="Descrição" FontSize="12" TextColor="#6B7280"/>
                    <Border Stroke="#E5E7EB" StrokeThickness="1" StrokeShape="RoundRectangle 10" BackgroundColor="White">
                        <Editor Placeholder="Descreva os detalhes da tarefa..."
                                PlaceholderColor="#9CA3AF"
                                Text="{Binding NewTaskDescription}"
                                AutoSize="TextChanges"
                                HeightRequest="92"
                                BackgroundColor="Transparent"
                                Margin="10,6"/>
                    </Border>

                    <Label Text="Prioridade" FontSize="12" TextColor="#6B7280"/>

                    <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="10">

                        <Border Stroke="#E5E7EB"
                                StrokeThickness="1"
                                StrokeShape="RoundRectangle 10"
                                BackgroundColor="White"
                                HeightRequest="40">
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SetPriorityCommand}"
                                                      CommandParameter="{x:Static enums:Priority.Low}"/>
                            </Border.GestureRecognizers>

                            <Label Text="Baixa"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   FontSize="13"
                                   TextColor="#111"/>
                            <Border.Triggers>
                                <DataTrigger TargetType="Border"
                                             Binding="{Binding NewTaskPriority}"
                                             Value="{x:Static enums:Priority.Low}">
                                    <Setter Property="BackgroundColor" Value="#EEF2FF"/>
                                    <Setter Property="Stroke" Value="#C7D2FE"/>
                                </DataTrigger>
                            </Border.Triggers>
                        </Border>

                        <Border Grid.Column="1"
                                Stroke="#E5E7EB"
                                StrokeThickness="1"
                                StrokeShape="RoundRectangle 10"
                                BackgroundColor="White"
                                HeightRequest="40">
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SetPriorityCommand}"
                                                      CommandParameter="{x:Static enums:Priority.Medium}"/>
                            </Border.GestureRecognizers>

                            <Grid ColumnDefinitions="*,Auto" Padding="0">
                                <Label x:Name="PriorityMediumLabel"
                                       Text="Média"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"
                                       FontSize="13"
                                       TextColor="#111"/>
                                <Label x:Name="PriorityMediumCaret"
                                       Grid.Column="1"
                                       VerticalOptions="Center"
                                       TextColor="#111"/>
                            </Grid>

                            <Border.Triggers>
                                <DataTrigger TargetType="Border"
                                             Binding="{Binding NewTaskPriority}"
                                             Value="{x:Static enums:Priority.Medium}">
                                    <Setter Property="BackgroundColor" Value="#EEF2FF"/>
                                    <Setter Property="Stroke" Value="#C7D2FE"/>
                                </DataTrigger>
                            </Border.Triggers>
                        </Border>

                        <Border Grid.Column="2"
                                Stroke="#E5E7EB"
                                StrokeThickness="1"
                                StrokeShape="RoundRectangle 10"
                                BackgroundColor="White"
                                HeightRequest="40">
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SetPriorityCommand}"
                                                      CommandParameter="{x:Static enums:Priority.High}"/>
                            </Border.GestureRecognizers>

                            <Label Text="Alta"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   FontSize="13"
                                   TextColor="#111"/>

                            <Border.Triggers>
                                <DataTrigger TargetType="Border"
                                             Binding="{Binding NewTaskPriority}"
                                             Value="{x:Static enums:Priority.High}">
                                    <Setter Property="BackgroundColor" Value="#FFF1F2"/>
                                    <Setter Property="Stroke" Value="#FECACA"/>
                                </DataTrigger>
                            </Border.Triggers>
                        </Border>

                        <Border Grid.Column="3"
                                Stroke="#E5E7EB"
                                StrokeThickness="1"
                                StrokeShape="RoundRectangle 10"
                                BackgroundColor="White"
                                HeightRequest="40">
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SetPriorityCommand}"
                                                      CommandParameter="{x:Static enums:Priority.Urgent}"/>
                            </Border.GestureRecognizers>

                            <Label Text="Urgente"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   FontSize="13"
                                   TextColor="#111"/>

                            <Border.Triggers>
                                <DataTrigger TargetType="Border"
                                             Binding="{Binding NewTaskPriority}"
                                             Value="{x:Static enums:Priority.Urgent}">
                                    <Setter Property="BackgroundColor" Value="#FFFBEB"/>
                                    <Setter Property="Stroke" Value="#FEF08A"/>
                                </DataTrigger>
                            </Border.Triggers>
                        </Border>

                    </Grid>

                    <Label Text="Data de Vencimento" FontSize="12" TextColor="#6B7280"/>

                    <Border Stroke="#E5E7EB" StrokeThickness="1" StrokeShape="RoundRectangle 10" BackgroundColor="White"
                            HeightRequest="44">
                        <Grid ColumnDefinitions="*,Auto" Padding="12,0">
                            <Label Text="{Binding NewTaskDueDate, StringFormat='{0:dd/MM/yyyy}'}"
                                   VerticalOptions="Center"
                                   TextColor="#111"/>
                            <Image Grid.Column="1"
                                   Source="calendar.svg"
                                   WidthRequest="18"
                                   HeightRequest="18"
                                   VerticalOptions="Center"
                                   Opacity="0.75"/>

                            <DatePicker x:Name="DueDatePicker"
                                        Grid.ColumnSpan="2"
                                        Date="{Binding NewTaskDueDate}"
                                        Opacity="0.01"
                                        BackgroundColor="Transparent" />
                        </Grid>
                    </Border>

                    <Label Text="Etiquetas" FontSize="12" TextColor="#6B7280"/>

                    <HorizontalStackLayout Spacing="10">

                        <Border Stroke="#E5E7EB" StrokeThickness="1" StrokeShape="RoundRectangle 10"
                                Padding="10,6" BackgroundColor="White">
                            <HorizontalStackLayout Spacing="8">
                                <BoxView WidthRequest="8" HeightRequest="8" CornerRadius="4" Color="#60A5FA" VerticalOptions="Center"/>
                                <Label Text="Trabalho" FontSize="12" TextColor="#111" VerticalOptions="Center"/>
                            </HorizontalStackLayout>
                        </Border>

                        <Border Stroke="#E5E7EB" StrokeThickness="1" StrokeShape="RoundRectangle 10"
                                Padding="10,6" BackgroundColor="White">
                            <HorizontalStackLayout Spacing="8">
                                <BoxView WidthRequest="8" HeightRequest="8" CornerRadius="4" Color="#34D399" VerticalOptions="Center"/>
                                <Label Text="Pessoal" FontSize="12" TextColor="#111" VerticalOptions="Center"/>
                            </HorizontalStackLayout>
                        </Border>

                        <Border Stroke="#E5E7EB" StrokeThickness="1" StrokeShape="RoundRectangle 10"
                                Padding="10,6" BackgroundColor="White">
                            <HorizontalStackLayout Spacing="8">
                                <BoxView WidthRequest="8" HeightRequest="8" CornerRadius="4" Color="#F87171" VerticalOptions="Center"/>
                                <Label Text="Urgente" FontSize="12" TextColor="#111" VerticalOptions="Center"/>
                            </HorizontalStackLayout>
                        </Border>

                    </HorizontalStackLayout>

                </VerticalStackLayout>
            </ScrollView>

            <Grid Grid.Row="3" RowDefinitions="Auto,Auto" Padding="16,12" RowSpacing="12">

                <BoxView Grid.Row="0" HeightRequest="1" Color="#EEEEEE" Margin="-16,0,-16,0"/>

                <Grid Grid.Row="1" ColumnDefinitions="*,*" ColumnSpacing="12">

                    <Button Text="Cancelar"
                            BackgroundColor="White"
                            TextColor="#111"
                            BorderColor="#E5E7EB"
                            BorderWidth="1"
                            CornerRadius="10"
                            HeightRequest="44"
                            Command="{Binding CloseManageTaskModalCommand}"/>

                    <Button Grid.Column="1"
                            Text="{Binding SaveButtonText}"
                            BackgroundColor="#111"
                            TextColor="White"
                            CornerRadius="10"
                            HeightRequest="44"
                            Command="{Binding ManageTaskCommand}"
                            IsEnabled="{Binding CanManageTask}"/>
                </Grid>
            </Grid>

        </Grid>
    </Border>
</ContentView>
